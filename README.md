# GitPulse

**[English](README.md) | [简体中文](README.zh-CN.md) | [日本語](README.ja.md) | [한국어](README.ko.md)**

AI-powered Git contribution analyzer. Analyze commits, score developer contributions across multiple dimensions, and generate performance reports.

## Features

- Multi-dimensional scoring: Code Quality, Complexity & Impact, Commit Discipline, Collaboration
- Customizable rubrics via Markdown files
- Multiple LLM provider support (OpenAI, Anthropic, Google, custom endpoints)
- Smart batching for cost-efficient analysis
- Incremental caching — only analyze new commits
- Multiple output formats: terminal, JSON, Markdown, HTML
- Privacy controls: anonymization, content exclusion

## Quick Start

```bash
# Install globally
npm install -g gitpulse-cli

# Configure (interactive wizard)
gitpulse config --init

# Analyze a repository
gitpulse analyze . --max-commits 10

# Generate report in different formats
gitpulse analyze . --format json -o report.json
gitpulse analyze . --format html -o report.html

# Compare two developers
gitpulse compare "Alice" "Bob"
```

## Home Directory (`~/.gitpulse/`)

First run (`gitpulse config --init` or any `gitpulse analyze`) automatically creates a global home directory:

```
~/.gitpulse/
├── rubrics/                       # Default rubric files (editable)
│   ├── code-quality.md
│   ├── complexity-impact.md
│   ├── commit-discipline.md
│   └── collaboration.md
├── cache/                         # Score cache (per-repo, auto-managed)
│   └── {repoName}-{hash}/scores/
├── repos/                         # Cloned remote repositories
│   └── {slug}-{hash}/
├── history/                       # Analysis history (one JSON per run)
│   └── {repoName}_{YYYYMMDD-HHmmss}_{id}.json
├── memory/                        # Agent memory
│   └── agent-memory.json
└── config.yml                     # Global configuration
```

- **rubrics/** — Copied from built-in defaults on first init. Edit these files to customize scoring globally. They are never overwritten on subsequent runs.
- **cache/** — Per-repo score cache keyed by commit hash. Avoids re-scoring unchanged commits across runs.
- **repos/** — Remote repositories cloned for analysis.
- **history/** — Each analysis run writes a summary JSON including scores, cost, and duration.
- **memory/** — Accumulates analysis counts per repo, rolling average scores, and inferred preferences (provider, model, format).
- **config.yml** — Global fallback config (see Configuration below).

## Configuration

GitPulse uses [cosmiconfig](https://github.com/cosmiconfig/cosmiconfig) for configuration. Settings are resolved in order of priority:

1. **Project-level** — `.gitpulse.yml` (or other cosmiconfig formats) in your project root
2. **Global-level** — `~/.gitpulse/config.yml`
3. **Built-in defaults** — Zod schema defaults

Create a `.gitpulse.yml` in your project root or edit `~/.gitpulse/config.yml`:

```yaml
provider: openai
model: gpt-4o

scoring:
  weights:
    codeQuality: 0.30
    complexityImpact: 0.25
    commitDiscipline: 0.25
    collaboration: 0.20
  timeDecay: false
  maxTokensPerDiff: 8000

analysis:
  maxConcurrency: 3
  skipMergeCommits: true
  skipLockFiles: true
  skipAutoGenerated: true

output:
  format: terminal
  anonymize: false

privacy:
  excludeFileContents: false
  anonymize: false
```

Set your API key via environment variable:

```bash
export OPENAI_API_KEY=sk-...
# or
export ANTHROPIC_API_KEY=sk-ant-...
```

## Custom Rubrics

Rubric files are searched in order:

1. Project-level: `<repo>/.gitpulse/rubrics/`
2. Global: `~/.gitpulse/rubrics/`
3. Built-in defaults bundled with the package

Override default scoring rubrics by placing Markdown files in either location:

```
.gitpulse/
  rubrics/
    code-quality.md
    complexity-impact.md
    commit-discipline.md
    collaboration.md
```

Run `gitpulse config --init` to populate `~/.gitpulse/rubrics/` with the built-in defaults, then edit them to your needs. See `rubrics/` in this repository for the default rubric format.

## CLI Commands

```
gitpulse analyze [path]        Analyze repository contributions
  -b, --branch <branch>        Branch to analyze
  --since / --until <date>     Date range
  --author <names...>          Filter by author
  --max-commits <n>            Limit commits
  --format <type>              terminal | json | markdown | html
  -o, --output <path>          Output file
  --no-cache                   Force re-scoring
  -y, --yes                    Skip confirmation
  --provider <type>            Override LLM provider
  --model <name>               Override model

gitpulse report [path]         Generate report from cache
gitpulse config --init         Initialize ~/.gitpulse/ + interactive setup
gitpulse config --show         Show current config
gitpulse compare <a1> <a2>     Compare two developers
```

Each `gitpulse analyze` run automatically:

- Creates `~/.gitpulse/` if it doesn't exist
- Prompts for a time range (last month / 3 months / 6 months / year / all / custom) when `--since`/`--until` and `-y` are not specified
- Records analysis results to `~/.gitpulse/history/`
- Updates agent memory in `~/.gitpulse/memory/agent-memory.json`

## Packages

| Package | Description |
|---------|-------------|
| `@gitpulse/core` | Core analysis engine, scoring, and report generation |
| `gitpulse-cli` | CLI tool |

## Development

```bash
# Install dependencies
pnpm install

# Build all packages
pnpm build

# Run tests
pnpm test

# Lint
pnpm lint
```

## Privacy & Ethics

- Only diff content is sent to LLM APIs, not full files
- Configure `excludeFileContents: true` to send only statistics
- Anonymization mode replaces names with deterministic pseudonyms
- Scores measure contribution characteristics, not developer worth

## License

[Apache-2.0](LICENSE)
